---
up: [[Коллекции]]
---
# Итераторы
---
### Что такое Iterator
Итератор позволяет осуществлять обход коллекции и при желании удалять избранные элементы. Используется интерфейс Iterator . Чтобы получить объект итератора, вызовите метод `Iterator<E> iterator()` .
Одним из ключевых методов интерфейса Collection является метод `Iterator<E>` iterator(). Он возвращает итератор - то есть объект, реализующий интерфейс Iterator.

Интерфейс Iterator имеет следующее определение:
```java
public interface Iterator <E>{     
    E next();
    boolean hasNext();
    void remove();
}
```

Реализация интерфейса предполагает, что с помощью вызова метода `next()` можно получить следующий элемент. С помощью метода `hasNext()` можно узнать, есть ли следующий элемент, и не достигнут ли конец коллекции. И если элементы еще имеются, то `hasNext()` вернет значение true. Метод `hasNext()` следует вызывать перед методом `next()`, так как при достижении конца коллекции метод `next()` выбрасывает исключение `NoSuchElementException`. И метод remove() удаляет текущий элемент, который был получен последним вызовом next().

### В чём разница между Iterable и Iterator
* **Iterable** - это интерфейс, все коллекции его имплементят, данный интерфейс предоставляем метод, который возвращает iterator. Так же данный интерфейс дает возможность использования foreach.
* **Iterator** - это тоже интерфейс, который дает нам методы перебора элементов коллекций и возможности удаления элементов, в отличии от обычного foreach где удалять нельзя.

### Чем различаются Enumeration и Iterator?
Iterator имеет больше методов работы с коллекциями и был специально введен в java2, вместо Enumeration(interface). Рекоммендуется использовать Iterator.

Оба интерфейса предназначены для обхода коллекции, но есть различия:
* с помощью Enumeration нельзя добавлять/удалять элементы;
* в Iterator исправлены имена методов для повышения читаемости кода (Enumeration.hasMoreElements() соответствует Iterator.hasNext(), Enumeration.nextElement() соответствует Iterator.next() и т.д);
* Enumeration присутствуют в устаревших классах, таких как Vector/Stack, тогда как Iterator есть во всех современных коллекциях.

### Как между собой связаны Iterable, Iterator и «for-each»?
Интерфейс Iterable имеет метод - iterator(), с типом возвращаемого значения - интерфейс Iterator.
Экземпляры классов, реализующих интерфейс Iterable, могут использоваться в цикле foreach.

### В каких случаях нужно использовать iterator и почему
В java.util есть класс Iterator, который может использоваться, когда итерация по списку или другой коллекции предполагает удаление элементов. Удалять элементы в цикле обхода последовательности for each нельзя.

### listIterator - что это, в чём отличие от обычного
  Iterator | ListIterator | 
------------------|---------------------|
Можно применить к любым классам коллекций | Можно применить только к объектам типа List |
Может двигаться только ВПЕРЕД | Может двигаться ВПЕРЕД и НАЗАД |
Может выполнять операции чтения и удаления | Может выполнять операции чтения, добавления, удаления и обнволения |

### Какая разница между итераторами с fail-fast и fail-safe поведением? (С примерами)
Итератор fail-safe не вызывает исключений при изменении структуры коллекции, потому что работает с её клоном.  
Пример fail-safe - CopyOnWriteArrayList и итератор keySet коллекции ConcurrentHashMap.  
  
Итератор fail-fast генерирует исключение ConcurrentModificationException, если коллекция меняется во время итерации, но работает быстрее.  
Пример fail-fast - Vector и Hashtable.

### Зачем в итераторе метод remove
Метод remove() удаляет текущий элемент, который был получен при последнем вызове next()

### Как поведёт себя коллекция, если вызвать iterator.remove()?
Этот метод удаляет текущий элемент. Важный момент заключается в том, что сначала этот элемент необходимо получить с помощью метода next(), если мы вызовем метод remove() до метода next(), то мы получим IllegalStateException.